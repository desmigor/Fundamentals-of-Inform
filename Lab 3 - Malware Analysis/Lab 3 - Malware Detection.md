# Lab 3: Malware Detection

> Igor Mpore
>
> BS19-CS01
>
> i.mpore@innopolis.university



# 0. Definitions

1. **Malware**

   This is any software intentionally designed to cause disruption to a computer, server, client, or computer network, leak private information, gain unauthorized access to information or systems, deprive users access to information or which unknowingly interferes with the user's

2. **Malware detection**

   Malware detection refers to the process of detecting the presence of malware on a host system or of distinguishing whether a specific program is malicious or benign.

# 1. Tools

There are a couple tools that can be used for Malware detection such as [Cuckoo Sandbox](https://cuckoo.readthedocs.io/en/latest/installation/). Cuckoo is a tool that allows you to perform Sandboxed malware analysis.

**A sandbox** is a security mechanism for separating running programs. It is often used to execute untested code, or untrusted programs from unverified third-parties, suppliers, untrusted users and untrusted websites. More about it from [here](https://cuckoo.readthedocs.io/en/latest/introduction/sandboxing/) . 

There are more other on-line tools that can help in malware detection such as [ANYRUN](https://any.run/) which we will be using in this exercise. 

<u>**Note**:</u> I didn't use Cuckoo Sandbox because I was having issues installing some libraries and dependencies to be able to run Cuckoo locally.



# 2. ANYRUN Malware Detector

### Step 0: Why analyzing this chosen  Malware

<u>Malware:</u> Ransomware WannaCry

A Ransomware is a type of malicious software which blocks access to a computer system until a sum of money is paid.  WannaCry is a famous ransomware that I had interest into and I wanted to get a deep understanding of how it works and exploits a system. WannaCry Initially tries to access a specific web address that turns out to be an unregistered nonsense name. If the program is able to open the URL, WannaCry can not execute, so it acts as a sort of kill switch.

<u>Targeted OS:</u> Microsoft Windows Operating System

<u>Years Active:</u> From May 2017 - Now (Since new versions of it are still improved) Never Safe :)

The full analysis can be found through [this link](https://app.any.run/tasks/00f4bd4e-400e-460f-86fb-c2ec8b069656/)



### Step 1: Environment Preparation

For the sake of safety, I used an online tool for Malware analysis as stated above called [any.run](any.run). I created an account and then started a new task. Since I didn't want to even download this malware on my laptop, I uploaded a random file to ANYRUN to start a VM.

![image-20220208004236463](/home/migor/snap/typora/49/.config/Typora/typora-user-images/image-20220208004236463.png)

![image-20220207235413334](/home/migor/snap/typora/49/.config/Typora/typora-user-images/image-20220207235413334.png)



### Step 2: Behavior analysis

- The Malware immediately added some images and other files on the desktop.

  ![image-20220208001112084](/home/migor/snap/typora/49/.config/Typora/typora-user-images/image-20220208001112084.png)

- After , the desktop changed immediately and then the Wana Decryptor launched. 

![image-20220208001348250](/home/migor/snap/typora/49/.config/Typora/typora-user-images/image-20220208001348250.png)

![image-20220208002247770](/home/migor/snap/typora/49/.config/Typora/typora-user-images/image-20220208002247770.png)

After this, I went to the browser myself and downloaded the malware and run the executable files. Now analysis was ready to be done. After the .exe was run, here is the simple report generated:

![image-20220208003057950](/home/migor/snap/typora/49/.config/Typora/typora-user-images/image-20220208003057950.png)

Here is also a list of processes that took place after the analysis:

![image-20220208004205973](/home/migor/snap/typora/49/.config/Typora/typora-user-images/image-20220208004205973.png)



### Step 3: Targeted files

We can see that **1599 files** were modified and **1 registry**. 

![image-20220208002853632](/home/migor/snap/typora/49/.config/Typora/typora-user-images/image-20220208002853632.png)

I went through some files including binary files, executables and some txt files and I went through to see if they contained some important information. Couldn't paste all the screen shoots here but they also contained important information.

### Step 4: Remote Addresses

This malware doesn't access any remote addresses during it's execution as shown in the report.

![image-20220208004422476](/home/migor/snap/typora/49/.config/Typora/typora-user-images/image-20220208004422476.png)

